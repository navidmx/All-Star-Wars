THREE.OrbitControls=function(e,t){function O(){return 2*Math.PI/60/60*n.autoRotateSpeed}function A(){return Math.pow(.95,n.zoomSpeed)}function C(e){if(n.enabled!==!1){if(e.preventDefault(),0===e.button){if(n.noRotate===!0)return;b=w.ROTATE,o.set(e.clientX,e.clientY)}else if(1===e.button){if(n.noZoom===!0)return;b=w.DOLLY,f.set(e.clientX,e.clientY)}else if(2===e.button){if(n.noPan===!0)return;b=w.PAN,s.set(e.clientX,e.clientY)}n.domElement.addEventListener("mousemove",L,!1),n.domElement.addEventListener("mouseup",x,!1),n.dispatchEvent(k)}}function L(e){if(n.enabled!==!1){e.preventDefault();var t=n.domElement===document?n.domElement.body:n.domElement;if(b===w.ROTATE){if(n.noRotate===!0)return;i.set(e.clientX,e.clientY),a.subVectors(i,o),n.rotateLeft(2*Math.PI*a.x/t.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*a.y/t.clientHeight*n.rotateSpeed),o.copy(i)}else if(b===w.DOLLY){if(n.noZoom===!0)return;p.set(e.clientX,e.clientY),d.subVectors(p,f),d.y>0?n.dollyIn():n.dollyOut(),f.copy(p)}else if(b===w.PAN){if(n.noPan===!0)return;c.set(e.clientX,e.clientY),u.subVectors(c,s),n.pan(u.x,u.y),s.copy(c)}n.update()}}function x(){n.enabled!==!1&&(n.domElement.removeEventListener("mousemove",L,!1),n.domElement.removeEventListener("mouseup",x,!1),n.dispatchEvent(H),b=w.NONE)}function S(e){if(n.enabled!==!1&&n.noZoom!==!0){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?n.dollyOut():n.dollyIn(),n.update(),n.dispatchEvent(k),n.dispatchEvent(H)}}function P(e){if(n.enabled!==!1&&n.noKeys!==!0&&n.noPan!==!0)switch(e.keyCode){case n.keys.UP:n.pan(0,n.keyPanSpeed),n.update();break;case n.keys.BOTTOM:n.pan(0,-n.keyPanSpeed),n.update();break;case n.keys.LEFT:n.pan(n.keyPanSpeed,0),n.update();break;case n.keys.RIGHT:n.pan(-n.keyPanSpeed,0),n.update()}}function B(e){if(n.enabled!==!1){switch(e.touches.length){case 1:if(n.noRotate===!0)return;b=w.TOUCH_ROTATE,o.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(n.noZoom===!0)return;b=w.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+r*r);f.set(0,i);break;case 3:if(n.noPan===!0)return;b=w.TOUCH_PAN,s.set(e.touches[0].pageX,e.touches[0].pageY);break;default:b=w.NONE}n.dispatchEvent(k)}}function j(e){if(n.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=n.domElement===document?n.domElement.body:n.domElement;switch(e.touches.length){case 1:if(n.noRotate===!0)return;if(b!==w.TOUCH_ROTATE)return;i.set(e.touches[0].pageX,e.touches[0].pageY),a.subVectors(i,o),n.rotateLeft(2*Math.PI*a.x/t.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*a.y/t.clientHeight*n.rotateSpeed),o.copy(i),n.update();break;case 2:if(n.noZoom===!0)return;if(b!==w.TOUCH_DOLLY)return;var r=e.touches[0].pageX-e.touches[1].pageX,l=e.touches[0].pageY-e.touches[1].pageY,h=Math.sqrt(r*r+l*l);p.set(0,h),d.subVectors(p,f),d.y>0?n.dollyOut():n.dollyIn(),f.copy(p),n.update();break;case 3:if(n.noPan===!0)return;if(b!==w.TOUCH_PAN)return;c.set(e.touches[0].pageX,e.touches[0].pageY),u.subVectors(c,s),n.pan(u.x,u.y),s.copy(c),n.update();break;default:b=w.NONE}}}function D(){n.enabled!==!1&&(n.dispatchEvent(H),b=w.NONE)}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var n=this,r=1e-6,o=new THREE.Vector2,i=new THREE.Vector2,a=new THREE.Vector2,s=new THREE.Vector2,c=new THREE.Vector2,u=new THREE.Vector2,l=new THREE.Vector3,h=new THREE.Vector3,f=new THREE.Vector2,p=new THREE.Vector2,d=new THREE.Vector2,v=0,m=0,g=1,y=new THREE.Vector3,E=new THREE.Vector3,w={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},b=w.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var T=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),R=T.clone().inverse(),M={type:"change"},k={type:"start"},H={type:"end"};this.rotateLeft=function(e){void 0===e&&(e=O()),m-=e},this.rotateUp=function(e){void 0===e&&(e=O()),v-=e},this.panLeft=function(e){var t=this.object.matrix.elements;l.set(t[0],t[1],t[2]),l.multiplyScalar(-e),y.add(l)},this.panUp=function(e){var t=this.object.matrix.elements;l.set(t[4],t[5],t[6]),l.multiplyScalar(e),y.add(l)},this.pan=function(e,t){var r=n.domElement===document?n.domElement.body:n.domElement;if(void 0!==n.object.fov){var o=n.object.position,i=o.clone().sub(n.target),a=i.length();a*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*e*a/r.clientHeight),n.panUp(2*t*a/r.clientHeight)}else void 0!==n.object.top?(n.panLeft(e*(n.object.right-n.object.left)/r.clientWidth),n.panUp(t*(n.object.top-n.object.bottom)/r.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=A()),g/=e},this.dollyOut=function(e){void 0===e&&(e=A()),g*=e},this.update=function(){var e=this.object.position;h.copy(e).sub(this.target),h.applyQuaternion(T);var t=Math.atan2(h.x,h.z),n=Math.atan2(Math.sqrt(h.x*h.x+h.z*h.z),h.y);this.autoRotate&&this.rotateLeft(O()),t+=m,n+=v,n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(r,Math.min(Math.PI-r,n));var o=h.length()*g;o=Math.max(this.minDistance,Math.min(this.maxDistance,o)),this.target.add(y),h.x=o*Math.sin(n)*Math.sin(t),h.y=o*Math.cos(n),h.z=o*Math.sin(n)*Math.cos(t),h.applyQuaternion(R),e.copy(this.target).add(h),this.object.lookAt(this.target),m=0,v=0,g=1,y.set(0,0,0),E.distanceToSquared(this.object.position)>r&&(this.dispatchEvent(M),E.copy(this.object.position))},this.reset=function(){b=w.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",C,!1),this.domElement.addEventListener("mousewheel",S,!1),this.domElement.addEventListener("DOMMouseScroll",S,!1),this.domElement.addEventListener("touchstart",B,!1),this.domElement.addEventListener("touchend",D,!1),this.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",P,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);
