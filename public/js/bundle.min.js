function changeColor(e){"blue"==e?(lightsaberColor="#00ffff",laserColor="#ff3346"):"green"==e?(lightsaberColor="#05B805",laserColor="#ff3346"):"red"==e&&(lightsaberColor="#ff0000",laserColor="#00ffff")}function changeBlue(){document.getElementById("blueSaber").style.opacity="1",document.getElementById("redSaber").style.opacity="0.5",document.getElementById("greenSaber").style.opacity="0.5",lightsaberColor="#00ffff",laserColor="#ff3346"}function changeGreen(){document.getElementById("greenSaber").style.opacity="1",document.getElementById("blueSaber").style.opacity="0.5",document.getElementById("redSaber").style.opacity="0.5",lightsaberColor="#05B805",laserColor="#ff3346"}function changeRed(){document.getElementById("redSaber").style.opacity="1",document.getElementById("blueSaber").style.opacity="0.5",document.getElementById("greenSaber").style.opacity="0.5",lightsaberColor="#ff0000",laserColor="#00ffff"}if(/Mobi/.test(navigator.userAgent))var isMobile=!0;var score=0,timer=65,gameOver=!1,lightsaberColor="#00ffff",laserColor="#ff3346";!function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return o(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){function n(e){var t=new THREE.Object3D,r=new THREE.PlaneGeometry(100,150),n=e.load("/textures/wall_deathstar.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(5,5);var o=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:n}),i=new THREE.PlaneGeometry(100,70),a=new THREE.MeshBasicMaterial({color:"green"}),s=new THREE.PlaneGeometry(70,150),c=e.load("/textures/floor_metal.jpg");c.wrapS=THREE.RepeatWrapping,c.wrapT=THREE.RepeatWrapping,c.repeat.set(5,5);var u=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:c}),l=new THREE.Mesh(r,o);l.position.set(20,0,-35);var f=l.clone();f.position.set(20,0,35),f.rotateY(Math.PI);var h=new THREE.Mesh(s,u);h.rotateY(Math.PI/2),h.position.set(-20,0,0);var p=new THREE.Mesh(i,a);return p.rotateX(-Math.PI/2),p.position.set(-20,50,0),t.add(l,f,h,p),t}t.exports=n},{}],2:[function(e,t,r){function n(){var e=new THREE.CylinderGeometry(.9,.9,4,12),t=new THREE.MeshBasicMaterial({transparent:!0,opacity:.75,color:laserColor}),r=new THREE.Mesh(e,t);return r.rotateZ(Math.PI/2),r}t.exports=n},{}],3:[function(e,t,r){function n(e,t){var r=e.load("/textures/floor_metal.jpg");r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(75,75),r.anisotropy=t.getMaxAnisotropy();var n=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:r}),o=new THREE.PlaneGeometry(500,500);return floor=new THREE.Mesh(o,n),floor.rotation.x=-Math.PI/2,floor}t.exports=n},{}],4:[function(e,t,r){function n(e){var t=new THREE.CylinderGeometry(.7,.7,6,7),r=new THREE.MeshBasicMaterial({color:"#545355"});return hand=new THREE.Mesh(t,r),hand.position.set(15,6,e.position.z/2),hand}t.exports=n},{}],5:[function(e,t,r){function n(){var e=new THREE.CylinderGeometry(.4,.4,30,20),t=new THREE.MeshBasicMaterial({color:"white"});lightsaber=new THREE.Mesh(e,t),lightsaber.position.setY(15);var r=new THREE.CylinderGeometry(.5,.5,30,20),n=new THREE.MeshBasicMaterial({transparent:!0,opacity:.5,color:lightsaberColor}),o=new THREE.Mesh(r,n);return lightsaber.add(o),lightsaber}t.exports=n},{}],6:[function(e,t,r){function n(e){var t=new THREE.SphereGeometry(1e4,1e4,25,25),r=new THREE.MeshBasicMaterial({map:e.load("textures/floor_metal.jpg"),side:THREE.BackSide}),n=new THREE.Mesh(t,r);return n.rotateY(-Math.PI/2),n}t.exports=n},{}],7:[function(e,t,r){function n(){var e=new THREE.CylinderGeometry(.7,.7,6,7),t=new THREE.MeshBasicMaterial({color:"#ffff00"});return enemy_1=new THREE.Mesh(e,t),enemy_1.position.set(15,-1e3,0),enemy_1}t.exports=n},{}],8:[function(e,t,r){function n(){this.raycaster=new THREE.Raycaster,this.collidableMeshList=[],this.collidedMeshes=[]}n.prototype.getRandomInRange=function(e,t){return Math.random()*(t-e)+e},n.prototype.playAudio=function(e){e.play()},n.prototype.checkCollision=function(e,t,r,n){r||(r=!1);for(var o=0;o<e.geometry.vertices.length;o++){var i=e.geometry.vertices[o].clone(),a=i.applyMatrix4(e.matrixWorld),s=a.sub(e.position);this.raycaster.set(e.position,s.clone().normalize());var c=this.raycaster.intersectObjects(this.collidableMeshList);if(c.length>0&&c[0].distance<s.length()){var u=c[0].object;if(u.name==t){if(r){for(var l=0;l<this.collidedMeshes.length;l++){var f=this.collidedMeshes[l];if(u.uuid==f)return}this.collidedMeshes.push(u.uuid)}n(u)}}}},n.prototype.cameraLookDir=function(e){var t=new THREE.Vector3(0,0,-1);return t.applyEuler(e.rotation,e.rotation.order),t},n.prototype.debugAxes=function(e,t){function r(e,t,r){return new THREE.Vector3(e,t,r)}function n(e,r,n){var o,i=new THREE.Geometry,a=new THREE.LineBasicMaterial({color:n,lineWidth:1});i.vertices.push(e,r),o=new THREE.Line(i,a),t.add(o)}n(r(-e,0,0),r(e,0,0),16711680),n(r(0,-e,0),r(0,e,0),65280),n(r(0,0,-e),r(0,0,e),255)};var o=new n;t.exports=o},{}],9:[function(e,t,r){function B(){R=!1,i=window.innerWidth,a=window.innerHeight,o=new THREE.Scene,s=new THREE.PerspectiveCamera(90,i/a,.001,2e4),c=new THREE.WebGLRenderer,u=new THREE.StereoEffect(c),l=new THREE.Clock,f=new THREE.TextureLoader,c.setSize(window.innerWidth,window.innerHeight),s.lookAt(0,0,0),s.position.set(0,15,0),o.add(s),d=document.getElementById("container"),v=c.domElement,p=new THREE.OrbitControls(s,v),p.target.set(s.position.x+.15,s.position.y,s.position.z),p.noPan=!0,p.noZoom=!0,isMobile&&(h=new DeviceOrientationController(s,c.domElement),h.connect()),$(".landing").fadeOut(100),$(".confirm-button").fadeOut(100),setTimeout(function(){setInterval(function(){timer>0&&(timer--,document.getElementById("timer").innerHTML=timer,60==timer?($("#timer").fadeIn(500),$("#timertitle").fadeIn(500),$("#score").fadeIn(500),$("#scoretitle").fadeIn(500),$("#introMessage").fadeOut(500)):0==timer&&_())},1e3)},5e3),d.appendChild(v),v.addEventListener("click",D,!1),P()}function P(){g=[];var e=new k(f);console.log(e),o.add(e),w=new H(f,c),o.add(w),b=new x(f),o.add(b),m=new C(s),E=new A,m.add(E),L.collidableMeshList.push(E),lightAngle=new THREE.PointLight(10066329,1,500),lightAngle.position.set(0,50,0),o.add(lightAngle);new THREE.AxisHelper(200);o.add(m),M=new S,o.add(M),requestAnimationFrame(F),j()}function j(){$("#introMessage").fadeIn(500)}function _(){$("#outroMessage").fadeIn(1e3),$("#winMessage").html("You have scored "+score+" points!"),$(".gameView").fadeOut(1e3)}function I(){o.add(m),y=new O,window.addEventListener("deviceorientation",N,!0),window.setInterval(function(){var e=y.clone();e.position.set(200,L.getRandomInRange(5,25),L.getRandomInRange(-10,10)),e.name="laser",e.velocity=new THREE.Vector3(-1.2,0,0),g.push(e),L.collidableMeshList.push(e),o.add(e)},Math.floor(200*Math.random()+900))}function D(){d.requestFullscreen?d.requestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.webkitRequestFullscreen&&d.webkitRequestFullscreen()}function N(e){e.alpha&&(h=new THREE.DeviceOrientationControls(s,!0),h.connect(),h.update(),window.removeEventListener("deviceorientation",N,!0))}function q(e,t){var i,a,s,r=t.g?t.g*(Math.PI/180):0,n=t.b?t.b*(Math.PI/180):0,o=t.a?t.a*(Math.PI/180):0,l=new THREE.Euler;a=n,s=r,i=o,l.set(0,-s,a-Math.PI/2),e.quaternion.setFromEuler(l)}function U(){var e=window.innerWidth,t=window.innerHeight;s.aspect=e/t,s.updateProjectionMatrix(),c.setSize(e,t),u.setSize(e,t)}function F(){l.getElapsedTime();requestAnimationFrame(F),z(l.getDelta()),isMobile?u.render(o,s):c.render(o,s)}function z(e){U(),s.updateProjectionMatrix(),p.update(e);var t=L.cameraLookDir(s);Math.abs(1-t.x)<.01&&!R&&(I(),R=!0);var r=["/sounds/hit1.wav","/sounds/hit2.wav","/sounds/hit3.wav","/sounds/hit4.wav"];L.checkCollision(E.children[0],"laser",!0,function(e){if(e){n.emit("sendhit"),e.velocity=new THREE.Vector3(1,0,0),score++,document.getElementById("score").innerHTML=score;var t=new Audio(r[Math.floor(4*Math.random())]);0==gameOver&&t.play()}});for(var i=0;i<g.length;i++){var a=g[i];a.position.add(a.velocity),(a.position.x<-10||a.position.x>200)&&(o.remove(a),g.splice(i,1))}isMobile&&h.update()}function Y(){console.log("Initiated powerAttack_1"),console.log(g)}var o,i,a,s,c,u,l,f,h,p,d,v,m,y,g,E,w,b,R,M,n=io(),k=e("../../assets/Sky"),H=e("../../assets/Floor"),x=e("../../assets/Corridor"),C=e("../../assets/Hand"),A=e("../../assets/Lightsaber"),O=e("../../assets/Laser"),S=e("../../assets/Enemy_1"),L=e("./utils");$(document).ready(function(){$(".confirm-button").click(function(){B(),F()})}),n.emit("viewerjoin",{room:roomId}),n.on("beginsetup",function(e){}),n.on("setupcomplete",function(e){$(".confirm-button").show(),n.emit("viewready")}),n.on("beginGame",function(e){console.log("Game has Begun"),changeColor(e.color),B(),F()}),n.on("updateorientation",function(e){m&&q(m,e)}),n.on("init_powerAttack_1",function(e){Y()}),n.on("updatemotion",function(e){})},{"../../assets/Corridor":1,"../../assets/Laser":2,"../../assets/Floor":3,"../../assets/Hand":4,"../../assets/Lightsaber":5,"../../assets/Sky":6,"../../assets/Enemy_1":7,"./utils":8}]},{},[9]);
